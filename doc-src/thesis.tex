\documentclass[12pt,a4paper,two-side]{book}
% vim: set ts=2 sts=2 sw=2 :

\usepackage{todonotes}

\usepackage{graphicx}
\usepackage{subcaption} % sub-figures
\usepackage{dpfloat}

\usepackage[utf8]{inputenc}

\usepackage{amsmath}    % Math
\usepackage[binary-units]{siunitx}    % SI units

% Use a blank space between paragraphs instead of an indent.
\usepackage[parfill]{parskip}

% Smart quotes
% Provides \enquote command
\usepackage [strict=true]{csquotes}
\MakeOuterQuote{"}  % Automatically treat quoted strings as quotes

% Source code listings
\usepackage{listings}
\lstset{basicstyle=\ttfamily\footnotesize,breaklines=false}

% Add bibliography, listings, and other pseudo-chapters to table of contents
\usepackage[
  nottoc  % skip the table of contents itself
]{tocbibind}
% Add list of listings to toc via tocbibind
\renewcommand{\lstlistoflistings}{\begingroup
\tocfile{\lstlistlistingname}{lol}
\endgroup}
% Add list of todos to toc via tocbibind
\renewcommand{\listoftodos}{\begingroup
\tocfile{Todo List}{tdo}
\endgroup}

\usepackage[
  backend=bibtex,
  backref=true, % add back-references from bib to citations
  urldate=long, % use date like "Apr. 7, 2017" instead of American "04/07/2017"
  % firstinits=true,    % use only initials of given names
]{biblatex}
\addbibresource{research.bib}

% Provide \url command
\usepackage{url}

% UiT official font: Open Sans
\usepackage[default]{opensans}

% Adjust caption spacing
\usepackage{caption}
\captionsetup[table]{skip=10pt}

% Nicer hlines for tables
\usepackage{booktabs}

% Link URLs in the PDF, and link references within the PDF itself
%
% The hyperref docs recommend declaring it after the other \usepackage
% declarations, because it has to redefine several commands to work properly,
% and other later redefinitions might interfere.
\usepackage[
  hidelinks,    % Do not style links. I think this is classier.
  pdfusetitle,  % Use doc title metadata for PDF title metadata
  bookmarksnumbered,      % use section numbers in PDF index
]{hyperref}

% Glossaries has to be declared AFTER hyperref for its links to work
\usepackage[toc]{glossaries}
\makeglossaries
% Glossary entries
\input{thesis-glossary}
% Emphasize first use of glossary term
\defglsentryfmt[main]{\ifglsused{\glslabel}{\glsgenentryfmt}{\emph{\glsgenentryfmt}}}



% Custom commands:

% Newly defined terms
\newcommand{\newterm}{\textit}

% An enumerated list with less spacing between items
\newenvironment{tight_enumerate}{
\begin{enumerate}
  \setlength{\itemsep}{0pt}
  \setlength{\parskip}{0pt}
}{\end{enumerate}}

% to-write
\usepackage{xcolor}
\usepackage[fit]{truncate}
\newcommand\towrite[1]{
  \addcontentsline{tdo}{todo}{\truncate{250pt}{Write: #1}}
  \textcolor{blue}{TODO: #1}
}

% feedback from Otto or Rolf
\newcommand{\perotto}[1]{\todo[color=blue!40]{Otto: #1}}
\newcommand{\perottoinline}[1]{\todo[color=blue!40,inline]{Otto: #1}}
\newcommand{\askotto}[1]{\todo[color=violet!40]{Ask Otto: #1}}
\newcommand{\askottoinline}[1]{\todo[color=violet!40,inline]{Ask Otto: #1}}

\newcommand{\perrolf}[1]{\todo[color=blue!20]{Rolf: #1}}
\newcommand{\perrolfinline}[1]{\todo[color=blue!20,inline]{Rolf: #1}}


% Move units
\newcommand{\gib}{\gibi\byte}
\newcommand{\mib}{\mebi\byte}
\newcommand{\kib}{\kibi\byte}


% Clear specifically to an even page
\newcommand\cleartoevenpage{%
   \clearpage%
   \ifodd\value{page}\mbox{}\clearpage\fi}


% Repeated text snippets

\newcommand{\explainlogsubfig}{Subfigure (a) shows the full range on a
logarithmic scale, while the others are linear-scale for specific ranges and
include error bars.}

\newcommand{\explaindiskspaceplot}{Subfigure (a) shows repository size on a
logarithmic scale, while subfigure (b) shows the ratio of total repository size
to input data size.}


% Current Git revision information
\input{vc_version.tex}


% Metadata

\title{Distributed Media Versioning \\
  \large Master's Thesis in Computer Science \\
        University of Troms√∏}
\author{Michael J. Murphy}
\date{May 2017}

% Metadata for PDF
\hypersetup{
  pdftitle=Master's Thesis: Distributed Media Versioning,
}



\begin{document}



\frontmatter
\pagestyle{empty}


% Put title page in PDF index
\phantomsection
\currentpdfbookmark{Title Page}{title}

\maketitle


\pagestyle{headings}

\input{thesis-abstract}
\input{thesis-acknowledgements}


% Put table of contents in the PDF index
\cleardoublepage
\phantomsection
\currentpdfbookmark{Contents}{contents}

\tableofcontents

\listoffigures
\listoftables

\renewcommand{\lstlistlistingname}{List of Code Listings}
%\lstlistoflistings

\listoftodos
\printglossaries



\mainmatter
\glsresetall

\input{thesis-intro}
\input{thesis-idea}
\input{thesis-architecture}
\input{thesis-design}
\input{thesis-implementation}
\input{thesis-vcs-scaling-exp}
\input{thesis-vcs-scaling-results}
\input{thesis-perf-tuning-exp}
\input{thesis-chunk-sizes-exp}
\input{thesis-discussion}
\input{thesis-related}
\input{thesis-contributions}
\input{thesis-conclusions}
\input{thesis-future-work}



\backmatter

%\nocite{*}  % Print all references even if they're not used
\printbibliography[heading=bibintoc]
\perrolfinline{Name consistency? Go either all full names or all initial plus
last name. In physics they go all initial plus last name. Can go initials with
one config option. Should I?}
\askottoinline{How do we do it in CS?}


% Colophon
\clearpage
\vspace*{\fill}
\input{thesis-colophon.tex}
\clearpage



\end{document}
