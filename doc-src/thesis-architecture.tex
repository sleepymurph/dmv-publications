\chapter{DMV Architecture}

Each \gls{DMV} node is a \newterm{repository} consisting of a
content-addressable \gls{objectstore} for immutable \gls{DAG} objects and a
\gls{workdir} for active file editing (\autoref{fig:dia_obj_db_and_wd}).
Repositories that are used only for storage can omit the \gls{workdir}, similar
to a Git bare repository.

\begin{figure}[h]
  \centering
    \includegraphics[width=0.5\textwidth]{dia_obj_db_and_wd}
  \caption{Repositories, object stores, and working directories}
  \label{fig:dia_obj_db_and_wd}
\end{figure}

Each repository is autonomous, storing a portion of the \gls{DAG}, and able to
add to it at any time. However, it can transfer \gls{DAG} objects to and from
other repositories, and it can cache data about what \gls{DAG} objects are
available at a remote repository. Thus, \gls{DMV} forms an ad-hoc, unstructured
network of repositories, and each repository can inform the user about what data
is available where. Together, the repositories hold the entire data set
(\autoref{fig:dia_architecture}).

\begin{figure}[h]
  \centering
    \includegraphics[width=0.95\textwidth]{dia_architecture}
  \caption{Repositories in an ad-hoc network}
  \label{fig:dia_architecture}
\end{figure}

\gls{DMV} assumes that each node will connect to a human-scale number of other
nodes, maybe tens or hundreds. \gls{DMV} does not dictate network structure. The
user or a higher-level application may determine the network topology and
workflow according to their needs.
