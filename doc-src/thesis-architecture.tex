\chapter{DMV Architecture}

Each \gls{DMV} node is a \gls{repository} consisting of a
content-addressable \gls{objectstore} for immutable \gls{DAG} objects and a
\gls{workdir} for active file editing (\autoref{fig:dia_obj_db_and_wd}).
\Glspl{repository} that are used only for storage can omit the \gls{workdir}, similar
to a Git bare \gls{repository}.

\begin{figure}[h]
  \centering
    \includegraphics[width=0.5\textwidth]{dia_obj_db_and_wd}
  \caption{Repositories, object stores, and working directories}
  \label{fig:dia_obj_db_and_wd}
\end{figure}

Each \gls{repository} is autonomous, storing a portion of the \gls{DAG}, and
able to add to it at any time. However, it can transfer \gls{DAG} objects to and
from other \glspl{repository}, and it can cache data about what \gls{DAG}
objects are available at a remote \gls{repository}. Thus, \gls{DMV} forms an
ad-hoc, unstructured network of \glspl{repository}, and each \gls{repository}
can inform the user about what data is available where. Together, the
\glspl{repository} hold the entire data set (\autoref{fig:dia_architecture}).
\Glspl{repository} may exist on separate computers or coexist on the same
computer. Some \glspl{repository} may be on removable storage and accessed only
when that storage is connected.

\begin{figure}[h]
  \centering
    \includegraphics[width=0.95\textwidth]{dia_architecture}
  \caption{Repositories in an ad-hoc network}
  \label{fig:dia_architecture}
\end{figure}

\gls{DMV} assumes that each \gls{repository} will connect to a human-scale
number of other \glspl{repository}, maybe tens or hundreds. \gls{DMV} does not
dictate network structure. The user or a higher-level application may determine
the network topology and workflow according to their needs.
